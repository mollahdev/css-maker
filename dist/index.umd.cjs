(function(a,l){typeof exports=="object"&&typeof module<"u"?module.exports=l():typeof define=="function"&&define.amd?define(l):(a=typeof globalThis<"u"?globalThis:a||self,a.index=l())})(this,function(){"use strict";var m=Object.defineProperty;var v=(a,l,h)=>l in a?m(a,l,{enumerable:!0,configurable:!0,writable:!0,value:h}):a[l]=h;var d=(a,l,h)=>(v(a,typeof l!="symbol"?l+"":l,h),h);class a{constructor(){d(this,"devices",{});d(this,"css",{});d(this,"rules",{});d(this,"ignoreKeys",["undefined","remove","false","null","NaN","","true"])}get uid(){return Math.floor(Math.random()*1e5)}canIgnore(e){return this.ignoreKeys.includes(e.trim())}removeOldProperties(e,t){e.split(",").filter(s=>!this.canIgnore(s)).forEach(s=>{const i=s.trim();delete t[i]})}sortDevices(){const e=this,t=Object.keys(e.devices);if(t.length<2)return;t.sort((s,i)=>e.devices[s]-e.devices[i]);const r={};t.forEach(function(s){r[s]=e.devices[s]}),e.devices=r}removeMultiWhiteSpace(e){return typeof e!="string"?e:e.trim().replace(/ +(?= )/g,"")}responsiveToHash(e){let t=[],r;for(r in e)t.push(r+"_"+e[r]);return t.join("-")}hashToResponsive(e){const t={};return e.split("-").filter(String).forEach(s=>{const[i,n]=s.split(/_(.+)/);t[i]=this.devices[n]}),t}sortHashes(){const e=this,{rules:t,hashToResponsive:r}=e,s=Object.keys(t);if(s.length<2)return t;s.sort(function(n,u){if(n==="all")return-1;if(u==="all")return 1;let o=r.call(e,n),c=r.call(e,u);if(o.max&&c.max)return c.max-o.max;if(o.min&&c.min)return c.min-o.min;const f=o.max!==null&&o.max!==void 0?o.max:o.min;return(c.max!==null&&c.max!==void 0?c.max:c.min)-f});const i={};return s.forEach(n=>{i[n]=t[n]}),i}createResponsiveFormat(e){const t=this.hashToResponsive.call(this,e),r=[];for(let s in t)r.push("("+s+"-width:"+t[s]+"px)");return"@media"+r.join(" and ")}convertProperties(e){let t="";for(let r in e)t+=r+":"+e[r]+";";return t}convertRules(e){let t="";for(let r in e){const s=this.convertProperties(e[r]);s&&(t+=r+"{"+s+"}")}return t}}class l extends a{addDevice(e,t){this.devices[e]=t,this.sortDevices()}addCSS(e){this.css[this.uid]=e}addRule(e,t,r){const s=this;let i="all",n={};if(e=s.removeMultiWhiteSpace(e),t=s.removeMultiWhiteSpace(t),r&&typeof r=="object"&&(i=s.responsiveToHash(r)),s.rules[i]||(s.rules[i]={}),s.rules[i][e]||(s.rules[i][e]={}),typeof t=="string"){n=t.split(";").filter(String);const u={};try{let o;for(o in n){const[c,f]=n[o].split(/:(.*)?/);c.trim()==="remove"&&this.removeOldProperties(f.trim(),s.rules[i][e]),!this.canIgnore(c)&&!this.canIgnore(f)&&(u[c.trim()]=f.trim().replace(";",""))}}catch{return}n=u}Object.assign(s.rules[i][e],n)}clear(){this.rules={},this.css={}}output(){const{css:e,convertRules:t,createResponsiveFormat:r,sortHashes:s}=this,i=s.call(this);let n="";for(let u in e)n+=e[u];for(let u in i){let o=t.call(this,i[u]);u!=="all"&&(o=r.call(this,u)+"{"+o+"}"),n+=o}return n.replace(/\s+/g," ")}}return l});
